# HandLog

## RU

### Описание
**HandLog** - это PHP класс, благодаря которому можно быстро и удобно логировать выполнение вашего кода.

*Важное замечание:* HandLog создан в первую очередь для отслеживания логических ошибок и оформления структурированного вывода и сохранения
сообщений связанных с выполнением тех или иных участков кода.

### Основные возможности
+ Гибкая настройка форматирования лога
  
+ Подсчёт времени, затраченного на выполнение логируемых событий
  
+ Сохранение лога в файл в режиме дозаписи или перезаписи
  
+ Отслеживание размера файла лога
  
+ Гибкий выбор отображаемых записей
  
+ Собственная терминология, обеспечивающая мощную вариативность применения

### Терминология

Работа класса основана на следующих понятиях:

**Информативная строка** - заданная пользователем строка сообщения, передающаяся в действии при добавлении записи.

**Тип действия** - тип действия, передающийся в действии при создании записи. Может принимать следующие значения:

+ 0 - харктеризует действие, как ошибку

+ 1 - характеризует действие, как успех

+ 2 - характеризует действие, как нейтральное

Типы действий нужны для последующего отбора записей для вывода.

**Действие** - в контексте класса массив, который содержит в себе информативную строку, её тип, имя события и  имя лога, которым принадлежит действие.
Является основным элементом взаимодействия кода пользователя с классом.

**Запись** - это форматированное по заданному шаблону действие, которое хранится как массив состоящий из времени добавления записи, 
информативной строки, типа действия и номера события, к которому принадлежит запись. Запись может быть форматирована из массива в строку
по заданному шаблону для вывода.

**Событие** - это заданная пользователем ассоциация записей с участками кода, которые их содержат. Задаётся пользователем для структурной
сортировки записей. Если не указывать, то добавляется в событие по умолчанию.

**Лог** - в контексте класса массив, в котором хранятся список событий и список записей. Один объект HandLog может содержать несколько логов.

### Краткое описание работы лога

0. Создание массива лога
1. Добавление записей
2. Вывод лога

### Версия PHP
При написании и отладке использовался PHP 7.2.8

### Описание массива настроек класса

**'note_string' => '[#time#] >> #string#'** : Шаблон строки форматированной записи при выводе, #time# - заменятеся на время добавления 
записи, а #string# - заменяется на информативную строку.

**'string_separator' => "\r\n"** : Межстрочный разделитель, который будет использоваться для разделения строк записей при выводе.

**'time_template' => "d-m-Y H:i:s"** : Шаблон времени, для функции date(), результат работы которой заменит метку #time# при выводе.

**'event_start_string' => ['[#time#]---> Event [ #event# ] started',1]** : Массив, нулевым элементом которого является шаблон строки начала
события, где метка #time# заменяется аналогично предыдущему шаблону, а метка #event# будет заменена на имя события. Элементом с индексом 1
является флаг отображения строки начала события при выводе, 0 - не показывать и 1 - показывать.

**'event_end_string' => ['[#time#]---> Event [ #event# ] ended. Spent time: #stime# sec',1]** : Массив, нулевым элементом которого является шаблон строки конца
события, где метка #time# заменяется аналогично предыдущему шаблону, метка #stime# заменяется временем в секундах, затраченным на данное событие,
а метка #event# будет заменена на имя события. Элементом с индексом 1 является флаг отображения строки конца события при выводе, 0 - не показывать и 1 - показывать.

**'log_start_string' => ['[#time#]---> Log [ #log# ] started',1]** : Массив, нулевым элементом которого является шаблон строки начала
лога, где метка #time# заменяется аналогично предыдущему шаблону, а метка #log# будет заменена на имя лога. Элементом с индексом 1
является флаг отображения строки начала события при выводе, 0 - не показывать и 1 - показывать.

**'log_end_string' => ['[#time#]---> Log [ #log# ] ended. Spent time: #stime# sec',1]** : Массив, нулевым элементом которого является шаблон строки конца
лога, где метка #time# заменяется аналогично предыдущему шаблону, метка #stime# заменяется временем в секундах, затраченным на события данного лога,
а метка #log# будет заменена на имя лога. Элементом с индексом 1 является флаг отображения строки конца события при выводе, 0 - не показывать и 1 - показывать.

**'select_mode' => 3** : Режим выбора записей. Может быть либо массивом либо числом. Если число:

+ 0 - последняя успешная запись, первая ошибка и нейтральные;

+ 1 - все успешыне записи, первая ошибка и нейтральные;

+ 2 - последняя успешная запись, все ошибки и нейтральные;

+ 3 - последняя успешная запись перед первой ошибкой и нейтральные.
                                      
Если массив, то будут выбираться те, чьи типы указаны; пример: [0,2] - выбираются ошибки и нейтральные.

**'default_event' => 'Main'** : Названия события по умолчанию.

**'default_log' => 'Default'** : Название лога по умолчанию. *Замечание:* если при создания объекта класса передать имя, то оно заменит
данное значение.

**'echo_mode' => 2** : Режим вывода записей.

+ 0 - прямое сохранение в файл

+ 1 - вывод лога на экран

+ 2 - вывод лога на экран и сохранение в файл

**'log_order' => 0** : Режим порядка отображения записей при выводе.

+ 0 - сначала новые записи

+ 0 - сначала старые записи

**'filename' => '#log#_lastLog.txt'** : Шаблон имени файла последнего лога, где метка #log# будет заменена на имя лога.

**'re_filename' => 'logsave_#log#_#time#.txt'** : Шаблон имени файла, в который переименуется файл лога при переполнении. Метка #log# будет заменена 
на имя лога, а метка #time# будет заменена на время переименования фалйа по шаблону 'refile_time_template'.

**'refile_time_template' => "d.m.Y_H-i-s"** : Формат времени для функции date(), которая заменит метку #time# в имени файла лога при переполнении.

**'file_size_limit' => 5\*1024\*1024** : Размер файла лога в байтах, при превышении которого файл лога будет переименован по шаблону 're_filename'.

**'dir' => 'Data/Logs'** : Директория, в которую будут сохраняться фалы логов. Значение '' означет запись в текущую директорию.

**'rewrite_mode' => 1** : Режим записи лога в файл.

+ 0 - дозапись в начало либо конец файла в зависимости от 'log_order'

+ 1 - перезапись файла

**'line_break_html' => 1** : Флаг замены символов перевода строки( \r\n ) в формат html ( <br> ) для корректного отображения в браузере при выводе(при этом в файл записывается версия без замены).

**'datum_filename' => 'handlog_datum.txt'** : Имя файла, в который выгрузится data, содержащая все логи в полном составе, при вызови функции класса datum_load_out($to).

### Примеры использования

